
Executing getFilteredCourses query:
            SELECT
                c.id,
                c.name,
                c.description,
                c.content_outline,
                c.duration_days,
                c.start_date,
                c.days_per_week,
                c.hours_per_day,
                c.status,
                c.is_published,
                c.is_launched,
                c.created_at,
                c.details,
                c.participant_config,
                COALESCE((
                    SELECT COUNT(*)
                    FROM enrollments e
                    WHERE e.course_id = c.id
                    AND e.status IN ('active', 'waiting_start')
                ), 0) as current_enrollment,
                CASE
                    WHEN COALESCE((c.details->>'max_seats')::integer, 999) <= COALESCE((
                        SELECT COUNT(*)
                        FROM enrollments e
                        WHERE e.course_id = c.id
                        AND e.status IN ('active', 'waiting_start')
                    ), 0) THEN 'full'
                    WHEN c.start_date < CURRENT_DATE THEN 'started'
                    ELSE 'available'
                END as availability_status
            FROM courses c
            WHERE (c.status = 'published' AND c.is_published = true)
            ORDER BY c.created_at DESC
            LIMIT $1 OFFSET $2

With parameters: [ 100, 0 ]
Error in getFilteredCourses: TypeError: pool.query is not a function
    at getFilteredCourses (lib\queryOptimizer.js:346:34)
    at eval (pages\courses.js:465:12)
    at eval (lib\withAuth.js:47:29)
  344 |         console.log('With parameters:', queryParams);
  345 |
> 346 |         const result = await pool.query(query, queryParams);
      |                                  ^
  347 |         return result.rows;
  348 |
  349 |     } catch (error) {
Courses page error: TypeError: pool.query is not a function
    at getFilteredCourses (lib\queryOptimizer.js:346:34)
    at eval (pages\courses.js:465:12)
    at eval (lib\withAuth.js:47:29)
  344 |         console.log('With parameters:', queryParams);
  345 |
> 346 |         const result = await pool.query(query, queryParams);
      |                                  ^
  347 |         return result.rows;
  348 |
  349 |     } catch (error) {